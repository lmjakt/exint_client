#include "sessionWidget.h"
#include "../../smallToggle/smallToggle.h"
#include <qpushbutton.h>
#include <qwidget.h>
#include <qstring.h>
#include <qlayout.h>
#include <qlabel.h>
#include <qlineedit.h>
#include <qcolor.h>
#include <qfont.h>
#include <qsizepolicy.h>
#include <set>
#include <iostream>

using namespace std;

SessionWidget::SessionWidget(int id, set<int>& g, set<QString>& kwd, QString& ti, QString& des, bool ownership, QWidget* parent, const char* name)
  : QWidget(parent, name)
{
  sessionId = id;
  setMaximumHeight(20);
  setFont(QFont("Arial", 8));
  genes = g;
  keyWords = kwd;
  title = ti;
  description = des;
  
  readOnly = !ownership;
  QColor bgColor;
  if(readOnly){
    bgColor = QColor(175, 150, 150);
  }else{
    bgColor = QColor(255, 255, 255);
  }

  QSizePolicy sizePolicy(QSizePolicy::Fixed, QSizePolicy::Expanding);
  //and set up a couple of buttons and a QLabel, or two.. or something like that.. ho yeahh.
  //QLineEdit* titleLabel = new QLineEdit(title, this, "titleLabel");
  QLabel* titleLabel = new QLabel(title, this, "titleLabel");
  titleLabel->setPaletteBackgroundColor(bgColor);
  //  titleLabel->setPaletteBackgroundColor(QColor(255, 255, 255));
  titleLabel->setMargin(3);
  QString size;
  size.setNum(genes.size());
  //QLineEdit* sizeLabel = new QLineEdit(size, this, "sizeLabel");  // this one we'll need to set a small space for.. 
  QLabel* sizeLabel = new QLabel(size, this, "sizeLabel");  // this one we'll need to set a small space for.. 
  sizeLabel->setPaletteBackgroundColor(bgColor);
  //  sizeLabel->setPaletteBackgroundColor(QColor(255, 255, 255));
  sizeLabel->setFixedWidth(23);
  sizeLabel->setMargin(2);

  SmallToggle* includeButton = new SmallToggle(1, this, "include"); 
  connect(includeButton, SIGNAL(toggled(bool)), this, SIGNAL(includeMe(bool)) );
  includeButton->setFixedWidth(25);
  QPushButton* displayButton = new QPushButton("info", this, "info");
  connect(displayButton, SIGNAL(clicked()), this, SIGNAL(displayMe()) );
  displayButton->setFixedWidth(40);
  displayButton->setSizePolicy(sizePolicy);
  includeButton->setSizePolicy(sizePolicy);

  QHBoxLayout* hBox = new QHBoxLayout(this);  // could have some other numbers..
  
  hBox->addWidget(sizeLabel);
  hBox->addWidget(displayButton);
  hBox->addWidget(includeButton);
  hBox->addWidget(titleLabel);
}

SessionWidget::SessionWidget(QWidget* parent, const char* name){
  title = "NULL NULL NULL NULL";
  QString size = "0";
  description = "NULL";
  readOnly = true;
 
  QSizePolicy sizePolicy(QSizePolicy::Expanding, QSizePolicy::Expanding);
  //and set up a couple of buttons and a QLabel, or two.. or something like that.. ho yeahh.
  QLabel* titleLabel = new QLabel(title, this, "titleLabel");
  QLabel* sizeLabel = new QLabel(size, this, "sizeLabel");  // this one we'll need to set a small space for.. 
  titleLabel->setPaletteBackgroundColor(QColor(255, 255, 255));
  sizeLabel->setPaletteBackgroundColor(QColor(255, 255, 255));
  titleLabel->setSizePolicy(sizePolicy);
  sizeLabel->setSizePolicy(sizePolicy);
  
  SmallToggle* includeButton = new SmallToggle(1, this, "include");
  connect(includeButton, SIGNAL(toggled(bool)), this, SIGNAL(includeMe(bool)) );
  QPushButton* displayButton = new QPushButton("info", this, "info");
  connect(displayButton, SIGNAL(clicked()), this, SIGNAL(displayMe()) );
  displayButton->setSizePolicy(sizePolicy);
  includeButton->setSizePolicy(sizePolicy);

  QHBoxLayout* hBox = new QHBoxLayout(this);  // could have some other numbers..
  
  hBox->addWidget(titleLabel);
  hBox->addWidget(sizeLabel);
  hBox->addWidget(displayButton);
  hBox->addWidget(includeButton);
}

set<int> SessionWidget::geneIds(){
  return(genes);
}

set<QString> SessionWidget::sessionKeyWords(){
  return(keyWords);
}

QString SessionWidget::sessionTitle(){
  return(title);
}

QString SessionWidget::sessionDescription(){
  return(description);
}

bool SessionWidget::canEdit(){
  return(!readOnly);
}
